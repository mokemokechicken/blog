<!doctype html><html class=no-js lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>scaf-code - Quickly Generate Code with ChatGPT - My First Step</title>
<script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script>
<meta name=description content>
<meta property="og:title" content="scaf-code - Quickly Generate Code with ChatGPT">
<meta property="og:description" content="scaf-code is a simple CLI tool that allows you to quickly generate code with ChatGPT referring to other files.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.my-first-step.info/en/tech/chatgpt/scaf-code/"><meta property="article:section" content="tech">
<meta property="article:published_time" content="2023-11-09T20:15:27+09:00">
<meta property="article:modified_time" content="2023-11-09T20:15:27+09:00"><meta property="og:site_name" content="My First Step">
<meta itemprop=name content="scaf-code - Quickly Generate Code with ChatGPT">
<meta itemprop=description content="scaf-code is a simple CLI tool that allows you to quickly generate code with ChatGPT referring to other files."><meta itemprop=datePublished content="2023-11-09T20:15:27+09:00">
<meta itemprop=dateModified content="2023-11-09T20:15:27+09:00">
<meta itemprop=wordCount content="551">
<meta itemprop=keywords content="ChatGPT,">
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=dns-prefetch href=//fonts.googleapis.com>
<link rel=dns-prefetch href=//fonts.gstatic.com>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=/css/my-style.css>
<link rel="shortcut icon" href=/favicon.ico>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SV0KGCR6DC"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-SV0KGCR6DC',{anonymize_ip:!1})}</script>
<script data-ad-client=ca-pub-9110784429846069 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
</head>
<body class=body>
<div class="container container--outer">
<header class=header>
<div class="container header__container">
<div class=logo>
<a class=logo__link href=/en/ title="My First Step" rel=home>
<div class="logo__item logo__text">
<div class=logo__title>My First Step</div>
</div>
</a>
</div>
<div class=divider></div>
</div>
</header>
<div class="wrapper flex">
<div class=primary>
<main class=main role=main>
<article class=post>
<header class=post__header>
<h1 class=post__title>scaf-code - Quickly Generate Code with ChatGPT</h1>
<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-11-09T20:15:27+09:00>2023-11-09</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/en/categories/chatgpt/ rel=category>ChatGPT</a>
</span>
</div>
<div class="meta__item-translations meta__item">
<span class=meta__text>Translations: <a class=meta__link href=/ja/tech/chatgpt/scaf-code/>JA</a>
</span>
</div></div>
</header>
<div class="post__toc toc">
<div class=toc__title>Page content</div>
<div class=toc__menu>
<nav id=TableOfContents>
<ul>
<li><a href=#introduction>Introduction</a></li>
<li><a href=#description-of-scaf-code>Description of scaf-code</a>
<ul>
<li><a href=#installation>Installation</a></li>
<li><a href=#how-to-use>How to Use</a></li>
<li><a href=#isnt-vscode--githubcopilotchat-good-enough>Isn&rsquo;t VSCode + GithubCopilotChat Good Enough?</a></li>
</ul>
</li>
<li><a href=#in-conclusion>In Conclusion</a></li>
</ul>
</nav>
</div>
</div><div class="content post__content clearfix">
<h2 id=introduction>Introduction</h2>
<p>OpenAI recently released a model called <code>gpt-4-1106-preview</code>. It can handle quite long texts of up to 128k tokens, which means it can now reference several normal text files without any issues.</p>
<p>So, for those times when you think, &ldquo;I&rsquo;d like to write a program like this, referring to similar programs I&rsquo;ve made before and using such specifications and type definitions,&rdquo; I&rsquo;ve created a command called <a href=https://github.com/mokemokechicken/scaf_code><code>scaf-code</code></a> that quickly generates a template-like file with ChatGPT.</p>
<h2 id=description-of-scaf-code>Description of scaf-code</h2>
<p>You will need an OpenAI API Key to use it.
※ (Charges will also apply there)</p>
<h3 id=installation>Installation</h3>
<pre tabindex=0><code>pip install scaf-code
</code></pre><h3 id=how-to-use>How to Use</h3>
<p>First, please set your OpenAI API Key as an environment variable.</p>
<pre tabindex=0><code>export OPENAI_API_KEY=&lt;your_openai_api_key&gt;
</code></pre><h4 id=the-simplest-way-to-use>The Simplest Way to Use</h4>
<p>The simplest way to use it is to specify <code>--out</code> and <code>--spec</code>.</p>
<pre tabindex=0><code>scaf_code --out tmp/add.py --spec “Create a command that takes multiple numbers from the command line, adds them all together, and outputs the result”
</code></pre><p>This will create a file like the following.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python:tmp/add.py data-lang=python:tmp/add.py><span style=color:#f92672>import</span> sys

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
    <span style=color:#75715e># Initialize the sum</span>
    total_sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>

    <span style=color:#75715e># Iterate over the arguments</span>
    <span style=color:#66d9ef>for</span> arg <span style=color:#f92672>in</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>:]:  <span style=color:#75715e># Skip the script name</span>
        <span style=color:#66d9ef>try</span>:
            <span style=color:#75715e># Convert each argument to an integer and add it to the sum</span>
            total_sum <span style=color:#f92672>+=</span> int(arg)
        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ValueError</span>:
            <span style=color:#75715e># Handle the case where the argument is not an integer</span>
            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error: ‘</span><span style=color:#e6db74>{</span>arg<span style=color:#e6db74>}</span><span style=color:#e6db74>’ is not a valid number.&#34;</span>)
            <span style=color:#66d9ef>return</span>

    <span style=color:#75715e># Output the sum</span>
    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;The sum is: </span><span style=color:#e6db74>{</span>total_sum<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)

<span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
    main()
</code></pre></div>
<p>The current version has some annoying code fences attached, so you have to remove them, but once removed, it was executable.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python tmp/add.py <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>4</span>
The sum is: <span style=color:#ae81ff>10</span>
</code></pre></div><p>Well, this much was possible even before.</p>
<h4 id=generating-code-while-referring-to-other-files>Generating Code While Referring to Other Files</h4>
<p>You can specify multiple files with the <code>--ref</code> option to make references. Since ChatGPT is only told the file name part, instructions like &ldquo;refer to ~&rdquo; are also effective.</p>
<pre tabindex=0><code>scaf_code --out tmp/mul.py --spec “Create a command that multiplies arguments, referring to add.py” --ref tmp/add.py
</code></pre><p>This will generate <code>tmp/mul.py</code>.</p>
<h4 id=buisiness-use>Buisiness use</h4>
<p>When you&rsquo;re iteratively creating code, you might want to keep in mind base classes, type files, common specifications, and instructions. It seems convenient to textually specify such things before giving instructions (though that&rsquo;s just a feeling).</p>
<p>You can use the <code>--spec-file</code> option to read the &ldquo;instructions&rdquo; part from a file.</p>
<p>So,</p>
<pre tabindex=0><code># Generate a new task!
scaf_code --out src/tasks/new_awesome_task.py \
  --spec-file doc/tasks/new_awesome_spec.md doc/task_guideline.md \
  --ref src/tasks/{similar_task.py,task_base_class.py}

# Generate a test along with it!
scaf_code --out tests/tasks/test_new_awesome_task.py \
  --spec-file doc/tasks/new_awesome_spec.md doc/task_guideline.md \
  --ref src/tasks/new_awesome_task.py tests/tasks/test_similar_task.py
</code></pre><p>I&rsquo;m hoping it can be generated like this.</p>
<h3 id=isnt-vscode--githubcopilotchat-good-enough>Isn&rsquo;t VSCode + GithubCopilotChat Good Enough?</h3>
<p>Copilot can do something similar, but it&rsquo;s not always easy to specify files clearly, and if you&rsquo;re using a different editor like PyCharm, it&rsquo;s not so straightforward. Also, being able to use it from the CLI is strong for various repetitions, I think.</p>
<p>With the acceptance of 128K Tokens, it seems likely that there will be cases where you want to create something &ldquo;with reference to ~&rdquo; for normal documents and various other files, so I made it for now.</p>
<h2 id=in-conclusion>In Conclusion</h2>
<p>Well, it&rsquo;s still rough, but it seems fun to be able to extend it in various ways, such as being able to reference images, handle various file formats (like docx?), fetch files from URLs, and integrate with <a href=https://platform.openai.com/docs/assistants/tools/code-interpreter>CodeInterpreter</a>.</p>
</div>
<footer class=post__footer>
<div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg>
<ul class=tags__list>
<li class=tags__item>
<a class="tags__link btn" href=/en/tags/chatgpt/ rel=tag>ChatGPT</a>
</li>
</ul>
</div>
</footer>
</article>
</main>
</div>
</div>
<footer class=footer>
<div class="container footer__container flex">
<div class=footer__links>
<a class=footer__link href=/en/etc/my_first_step/>About This Blog</a>
</div>
<div class=footer__copyright>
&copy; 2023 Mokemokechicken.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span>
</div>
</div>
</footer>
</div>
<script async defer src=/js/menu.js></script>
</body>
</html>